<!doctype html> 
<html lang="en"> 
<head> 
	<meta charset="UTF-8" />
	<title>Septikon</title>
    <script src="//cdn.jsdelivr.net/phaser/2.2.2/phaser.min.js"></script>
    <style type="text/css">
        body {
            margin: 0;
        }
    </style>
</head>
<body>

<script type="text/javascript">

var game = new Phaser.Game(1000, 700, Phaser.AUTO, '', { preload: preload, create: create, update: update });

function preload() {
    game.load.script('filterX', 'https://cdn.rawgit.com/photonstorm/phaser/master/filters/BlurX.js');
    game.load.script('filterY', 'https://cdn.rawgit.com/photonstorm/phaser/master/filters/BlurY.js');
    
    game.load.image('board', 'assets/medium_board.png');
    game.load.image('clone', 'assets/clone.png');
}

var clone;
var wasd;
var cursors;

function create() {
    game.physics.startSystem(Phaser.Physics.Arcade);
    
    game.add.sprite(0, 0, 'board');
    clone = game.add.sprite(81, 37, 'clone');
    game.physics.arcade.enable(clone);
    clone.scale.setTo(0.25);
    clone.angle = 90;
    

    this.cursors = game.input.keyboard.createCursorKeys();

    this.wasd = {
        up: game.input.keyboard.addKey(Phaser.Keyboard.W),
        down: game.input.keyboard.addKey(Phaser.Keyboard.S),
        left: game.input.keyboard.addKey(Phaser.Keyboard.A),
        right: game.input.keyboard.addKey(Phaser.Keyboard.D),
    };
    
    console.log(clone);
}

var movementRate = 150;
var previousX;
var isMovingX = false;
var targetX;
var previousY;
var isMovingY = false;
var targetY;

function update() {
    
    clone.body.velocity.x = 0;
    clone.body.velocity.y = 0;
    
    if (this.wasd.left.isDown && !this.isMovingX)
    {
        this.isMovingX = true;
        this.previousX = clone.body.x;
        this.targetX = this.previousX-29;
    }
    else if (this.wasd.right.isDown && !this.isMovingX)
    {
        this.isMovingX = true;
        this.previousX = clone.body.x;
        this.targetX = this.previousX+29;
    }
    
    if (this.wasd.up.isDown && !this.isMovingY)
    {
        this.isMovingY = true;
        this.previousY = clone.body.y;
        this.targetY = this.previousY-29;
    }
    else if (this.wasd.down.isDown && !this.isMovingY)
    {
        this.isMovingY = true;
        this.previousY = clone.body.y;
        this.targetY = this.previousY+29;
    }
    
    if(this.isMovingX) {
        //LEFT of target?
        if (this.previousX > this.targetX && clone.body.x <= this.targetX) {
            this.isMovingX = false;
        }
        else if (this.previousX < this.targetX && clone.body.x >= this.targetX) {
            this.isMovingX = false;
        }
        else if (this.previousX > this.targetX) {
            clone.body.velocity.x = -200;
        }
        else if (this.previousX < this.targetX) {
            clone.body.velocity.x = 200;
        }
    }
    if(this.isMovingY) {
        //LEFT of target?
        if (this.previousY > this.targetY && clone.body.y <= this.targetY) {
            this.isMovingY = false;
        }
        else if (this.previousY < this.targetY && clone.body.y >= this.targetY) {
            this.isMovingY = false;
        }
        else if (this.previousY > this.targetY) {
            clone.body.velocity.y = -200;
        }
        else if (this.previousY < this.targetY) {
            clone.body.velocity.y = 200;
        }
    }
    
}

</script>

</body>
</html>
